const translations = {
    en: {
        nav_home: "Status / Home",
        nav_projects: "Quests / Projects",
        nav_skills: "Skills",
        nav_about: "Lore / About",
        hero_status: "STATUS",
        hero_job: "JOB: MOTION DESIGNER",
        hero_title: "TITLE: THE VISUALIZOR",
        hero_exp: "EXP",
        hero_enter: "ENTER DUNGEON",
        sect_projects_title: "Instance Dungeons",
        sect_projects_subtitle: "My Projects",

        // Meta Labels & Values
        meta_cat: "Category:",
        meta_year: "Year:",
        meta_role: "Role:",

        project_difficulty: "DIFFICULTY:",
        project_headlock: "Headlock Edit",
        h1_headlock: "Edit Motion Design - Headlock",
        project_headlock_desc: "Rhythmic visual synchronization.",
        project_clip: "Music video",
        h1_clip: "Music Video",
        project_clip_desc: "Video production with VFX.",
        project_clip_iut: "Academy Promotion",
        h1_clip_iut: "Academy Presentation Clip",
        project_clip_iut_desc: "Student life promotional video.",
        project_hypnose: "Visual of the hypnosis evening",
        h1_hypnose: "Event Horizon (Hypnosis Night)",
        project_hypnose_desc: "Charity event visual identity.",
        project_photo: "Animal photography",
        h1_photo: "Animal Photography",
        project_photo_desc: "Artistic photography series.",
        see_all_quests: "SEE ALL QUESTS",
        sect_skills_title: "Active Skills",
        sect_skills_subtitle: "Technical skills",
        skill_post_prod: "Post-Production",
        skill_graphic: "Graphic Design",
        sect_about_title: "Player Logs",
        sect_about_subtitle: "About Me",
        about_bio: "\"I reawaken ideas through motion and imagery.\"",
        about_system: "> SYSTEM: Player seeks to create impactful visual experiences.",
        download_cv: "DOWNLOAD DATA",
        contact_msg: "SUMMON THE SHADOW MONARCH?",
        contact_sub: "(CONTACT)",
        contact_btn: "ARISE",
        footer_system: "SYSTEM ONLINE.",
        // Projects Page
        projects_page_title: "Quest Log",
        projects_page_subtitle: "All Projects",
        cat_motion: "Motion & Visuals",
        cat_comm: "Communication",
        cat_photo: "Photography",

        val_av: "Audiovisual",
        val_edit: "Editing",
        val_director: "Director",
        val_motion: "Motion Design",
        val_motion_designer: "Motion Designer",
        val_photo: "Photography",
        val_photographer: "Photographer",
        val_comm: "Communication",
        val_event: "Event",
        val_graphic: "Graphic Design",
        val_visual_graphist: "Visual Designer",
        start_quest: "SEE QUEST",
        view_log: "VIEW LOG",
        // Project Detail
        back_quests: "← RETURN TO QUEST LOG",
        project_context: "Context",
        project_sol: "Solution",
        prev_project: "Previous Quest",
        next_project: "Next Quest",
        // Project Detail Structure
        p_the_project: "The Project",
        p_approach: "Creative Approach",
        p_tools: "Tools Used",
        p_resources: "Resources",
        p_view_drive: "View Drive Folder",
        // Modal
        modal_title: "SUMMONING SHADOW",
        modal_email_copied: "Shadow Extracted:",
        modal_btn_done: "DONE",
        modal_btn_copy: "COPY",
        // Project: Headlock
        p_headlock_desc_1: "A rhythmic motion design project set to the track 'Headlock'. This project explores visual synchronization with sound and the use of dynamic geometric shapes.",
        p_headlock_approach_1: "The goal was to create an immersive visual experience that perfectly follows the rhythm of the music, using fluid animations and impactful transitions.",
        p_headlock_tools_1: "Software: After Effects",
        p_headlock_resources_1: "The project is available on the Drive.",
        // Project: Clip
        p_clip_desc_1: "This music video was produced as part of a digital creation course. It highlights my skills in video editing and artistic direction.",
        p_clip_approach_1: "The objective was to create a music video for a song of our choice. The goal was to showcase our ability to tell a story through image and sound, and to apply our skills.",
        p_clip_tools_1: "Software: Adobe After Effects, Adobe Photoshop, Adobe Premiere Pro",
        p_clip_resources_1: "Access the music video on the Drive.",
        // Project: Clip IUT
        p_clip_iut_desc_1: "This project involves creating a promotional video to present my IUT. The goal was to highlight student life and the institution's infrastructure.",
        p_clip_iut_approach_1: "I sought to capture authentic and dynamic moments to convey the atmosphere of the IUT.",
        p_clip_iut_tools_1: "Software: Adobe Premiere Pro, Adobe After Effects",
        p_clip_iut_resources_1: "Access the video on the Drive.",
        // Project: Photo
        p_photo_desc_1: "This series captures a feline subject encountered during an outdoor exploration.",
        p_photo_approach_1: "Utilized natural environment variables. Subject engaged in vertical traversal (tree climbing), presenting optimal capture opportunities.",
        p_photo_tools_1: "Gear: Canon EOS 2000D, 18-55mm f/3.5-5.6",
        p_photo_tools_2: "Software: Adobe Lightroom",
        p_photo_resources_1: "Access full image database on the Drive.",
        // Project: Hypnose
        p_hypnose_msg: "> INITIALIZING PROJECT DATA...",
        p_hypnose_desc_1: "Create a strong and modern visual identity for the second edition of the Hypnosis Night in Lens. This project is organized by a group of TC students who called upon my team to create a visual identity for the event.",
        p_hypnose_approach_1: "The result is a visual identity that is modern and bold. Using a color palette reminiscent of night, hypnosis, and dreams to instantly convey the theme.",
        p_hypnose_tools_1: "Software: Adobe Photoshop, Adobe Illustrator",
        p_hypnose_resources_1: "Access all project files and deliverables on the Drive."
    },
    fr: {
        nav_home: "Statut / Accueil",
        nav_projects: "Quêtes / Projets",

        // Meta Labels & Values
        meta_cat: "Catégorie :",
        meta_year: "Année :",
        meta_role: "Rôle :",

        val_av: "Audiovisuel",
        val_edit: "Montage",
        val_director: "Réalisateur",
        val_motion: "Motion Design",
        val_motion_designer: "Motion Designer",
        val_photo: "Photographie",
        val_photographer: "Photographe",
        val_comm: "Communication",
        val_event: "Événementiel",
        val_graphic: "Graphisme",
        val_visual_graphist: "Graphiste Visuel",

        nav_skills: "Compétences",
        nav_about: "Lore / À Propos",
        hero_status: "STATUT",
        hero_job: "CLASSE : MOTION DESIGNER",
        hero_title: "TITRE : LE VISUALISEUR",
        hero_exp: "EXP",
        hero_enter: "ENTRER DANS LE DONJON",
        sect_projects_title: "Donjons d'Instance",
        sect_projects_subtitle: "Mes Projets",
        project_difficulty: "DIFFICULTÉ :",
        project_headlock: "Edit Headlock",
        h1_headlock: "Montage Motion Design - Headlock",
        project_headlock_desc: "Synchronisation visuelle rythmique.",
        project_clip: "Clip Vidéo",
        h1_clip: "Clip de musique",
        project_clip_desc: "Production vidéo avec VFX.",
        project_clip_iut: "Promotion IUT",
        h1_clip_iut: "Clip de présentation IUT",
        project_clip_iut_desc: "Vidéo promotionnelle vie étudiante.",
        project_hypnose: "Affiche Soirée Hypnose",
        h1_hypnose: "Event Horizon (Soirée Hypnose)",
        project_hypnose_desc: "Identité visuelle événement caritatif.",
        project_photo: "Photographie Animale",
        h1_photo: "Photographie Animale",
        project_photo_desc: "Série photo artistique.",
        see_all_quests: "VOIR TOUTES les quêtes",
        sect_skills_title: "Compétences Actives",
        sect_skills_subtitle: "Compétences techniques",
        skill_post_prod: "Post-Production",
        skill_graphic: "Design Graphique",
        sect_about_title: "Logs du Joueur",
        sect_about_subtitle: "À Propos",
        about_bio: "\"Je réveille les idées par le mouvement et l'image.\"",
        about_system: "> SYSTEME : Le joueur cherche à créer des expériences visuelles impactantes.",
        download_cv: "TÉLÉCHARGER DONNÉES",
        contact_msg: "INVOQUER LE MONARQUE DES OMBRES ?",
        contact_sub: "(CONTACT)",
        contact_btn: "SURGIS",
        footer_system: "SYSTÈME EN LIGNE.",
        // Projects Page
        projects_page_title: "Journal de Quêtes",
        projects_page_subtitle: "Tous les Projets",
        cat_motion: "Motion & Visuels",
        cat_comm: "Communication",
        cat_photo: "Photographie",
        start_quest: "VOIR LA QUÊTE",
        view_log: "VOIR LOG",
        // Project Detail
        back_quests: "← RETOUR JOURNAL QUÊTES",
        project_context: "Contexte",
        project_sol: "Solution",
        prev_project: "Quête Précédente",
        next_project: "Quête Suivante",
        // Project Detail Structure
        p_the_project: "Le Projet",
        p_approach: "Approche Créative",
        p_tools: "Outils Utilisés",
        p_resources: "Ressources",
        p_view_drive: "Voir le dossier Drive",
        // Modal
        modal_title: "INVOCATION DE L'OMBRE",
        modal_email_copied: "Ombre Extraite :",
        modal_btn_done: "TERMINÉ",
        modal_btn_copy: "COPIER",
        // Project: Headlock
        p_headlock_desc_1: "Un projet de motion design rythmé sur la musique 'Headlock'. Ce projet explore la synchronisation visuelle avec le son et l'utilisation de formes géométriques dynamiques.",
        p_headlock_approach_1: "L'objectif était de créer une expérience visuelle immersive qui suit parfaitement le rythme de la musique, en utilisant des animations fluides et des transitions percutantes.",
        p_headlock_tools_1: "Logiciels : After Effects",
        p_headlock_resources_1: "Le projet est disponible sur le Drive.",
        // Project: Clip
        p_clip_desc_1: "Ce clip de musique a été réalisé dans le cadre d'un cours de création numérique. Il met en avant mes compétences en montage vidéo et en direction artistique.",
        p_clip_approach_1: "L'objectif était de créer un clip sur la musique de notre choix. Le but était de mettre en avant notre capacité à raconter une histoire à travers l'image et le son et aussi de mettre à usage nos compétences.",
        p_clip_tools_1: "Logiciels : Adobe After Effects, Adobe Photoshop, Adobe Premiere Pro",
        p_clip_resources_1: "Accédez à la vidéo du clip sur le Drive.",
        // Project: Clip IUT
        p_clip_iut_desc_1: "Ce projet consiste en la réalisation d'un clip vidéo promotionnel pour présenter mon IUT. L'objectif était de mettre en valeur la vie étudiantes et les infrastructures de l'établissement.",
        p_clip_iut_approach_1: "J'ai cherché à capturer des moments authentiques et dynamiques pour retranscrire l'atmosphère de l'IUT.",
        p_clip_iut_tools_1: "Logiciels : Adobe Premiere Pro, Adobe After Effects",
        p_clip_iut_resources_1: "Accédez à la vidéo sur le Drive.",
        // Project: Photo
        p_photo_desc_1: "Cette série capture un sujet félin rencontré lors d'une exploration extérieure.",
        p_photo_approach_1: "Utilisation des variables de l'environnement naturel. Sujet engagé dans une traversée verticale (escalade d'arbre), présentant des opportunités de capture optimales.",
        p_photo_tools_1: "Équipement : Canon EOS 2000D, 18-55mm f/3.5-5.6",
        p_photo_tools_2: "Logiciel : Adobe Lightroom",
        p_photo_resources_1: "Accédez à la base de données images complète sur le Drive.",
        // Project: Hypnose
        p_hypnose_msg: "> INITIALISATION DONNÉES PROJET...",
        p_hypnose_desc_1: "Créer une identité visuelle forte et moderne pour la deuxième édition de la Nuit de l'Hypnose à Lens. Ce projet est organisé par un groupe d'étudiants en TC qui a fait appel à mon équipe pour créer une identité visuelle pour l'événement.",
        p_hypnose_approach_1: "Le résultat est une identité visuelle moderne et audacieuse. Utilisant une palette de couleurs rappelant la nuit, l'hypnose et les rêves pour transmettre instantanément le thème.",
        p_hypnose_tools_1: "Logiciels : Adobe Photoshop, Adobe Illustrator",
        p_hypnose_resources_1: "Accédez à tous les fichiers et livrables du projet sur le Drive."
    }
};

function updateLanguage(lang) {
    localStorage.setItem('preferredLanguage', lang);
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
            if (element.classList.contains('cta-button')) {
                const spanTags = Array.from(element.querySelectorAll('span')).map(span => span.outerHTML).join('');
                element.innerHTML = spanTags + " " + translations[lang][key].trim();
            } else {
                element.innerText = translations[lang][key];
            }
        }
    });

    // Update button text if it exists
    const toggleBtn = document.getElementById('lang-toggle');
    if (toggleBtn) toggleBtn.innerText = lang === 'en' ? 'EN' : 'FR';
}

document.addEventListener('DOMContentLoaded', () => {
    // Language Init
    const savedLang = localStorage.getItem('preferredLanguage') || 'fr';
    updateLanguage(savedLang);

    // Toggle Button Listener
    const langToggle = document.getElementById('lang-toggle');
    if (langToggle) {
        langToggle.addEventListener('click', () => {
            const currentLang = localStorage.getItem('preferredLanguage') || 'fr';
            const newLang = currentLang === 'en' ? 'fr' : 'en';
            updateLanguage(newLang);
        });
    }

    const hamburger = document.querySelector('.hamburger');
    const navLinks = document.querySelector('.nav-links');

    // Toggle Mobile Menu
    if (hamburger && navLinks) {
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navLinks.classList.toggle('active');
        });
    }

    // Scroll Animations (Intersection Observer)
    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
    };

    const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('is-visible');
                observer.unobserve(entry.target);
            }
        });
    }, observerOptions);

    document.querySelectorAll('.fade-in-section').forEach(section => {
        observer.observe(section);
    });

    // Antigravity Effect (Random Float for Project Cards)
    const cards = document.querySelectorAll('.project-card');
    document.querySelectorAll('.project-card').forEach(card => {
        card.addEventListener('click', (e) => {
            // Prevent recursive click if clicking the link directly
            if (e.target.tagName === 'A' || e.target.closest('a')) return;

            const link = card.querySelector('a');
            if (link) {
                link.click();
            }
        });

        // Random duration between 3s and 6s
        const duration = 3 + Math.random() * 3;
        // Random delay between 0s and 3s
        const delay = Math.random() * 3;

        card.style.animation = `antigravity ${duration}s ease-in-out infinite`;
        card.style.animationDelay = `${delay}s`;
    });

    // Back to Top Button
    const backToTopButton = document.getElementById('back-to-top');
    if (backToTopButton) {
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                backToTopButton.classList.add('visible');
            } else {
                backToTopButton.classList.remove('visible');
            }
        });

        backToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    }

    // Arise Button Shockwave Effect (Optional enhancement)
    const ariseBtns = document.querySelectorAll('.cta-button');
    ariseBtns.forEach(btn => {
        btn.addEventListener('click', function (e) {
            // Visual feedback handled by CSS active state
            console.log("SYSTEM: ARISE command initiated.");
        });
    });


    // System Boot Message
    console.log("SYSTEM: Shadow Monarch Interface Loaded.");
    console.log("SYSTEM: Rank Evaluation Completed.");

    /* --- NAVIGATION SCROLL SPY --- */
    const sections = document.querySelectorAll('section');
    const navItems = document.querySelectorAll('.nav-links li a');

    function highlightNavigation() {
        let scrollY = window.scrollY;

        sections.forEach(current => {
            const sectionHeight = current.offsetHeight;
            const sectionTop = current.offsetTop - 100; // Offset for header
            const sectionId = current.getAttribute('id');

            if (scrollY > sectionTop && scrollY <= sectionTop + sectionHeight) {
                navItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('href').includes(sectionId)) {
                        item.classList.add('active');
                    }
                });
            }
        });

        // Handle "Home" being active at the very top if not covered by section loop
        if (scrollY < 100) {
            navItems.forEach(item => item.classList.remove('active'));
            const homeLink = document.querySelector('.nav-links li a[href="#home"]');
            if (homeLink) homeLink.classList.add('active');
        }
    }

    window.addEventListener('scroll', highlightNavigation);
    highlightNavigation(); // Initial check

    /* --- SUMMONING RITUAL (CONTACT MODAL) --- */
    createSummonModal();

    function createSummonModal() {
        // 1. Inject Layout
        const modalHTML = `
        <div id="summonModal" class="modal-overlay">
            <div class="modal-content">
                <span class="modal-close">&times;</span>
                <h2 class="modal-title" data-i18n="modal_title">SUMMONING SHADOW</h2>
                
                <div class="copy-row">
                    <span class="copy-text">alexiscarpentier62@gmail.com</span>
                    <button class="copy-btn" data-copy="alexiscarpentier62@gmail.com" data-i18n="modal_btn_copy">COPY</button>
                </div>

                <div class="copy-row">
                    <span class="copy-text">Instagram: @crpt.alexis</span>
                    <button class="copy-btn" data-copy="https://instagram.com/crpt.alexis" data-i18n="modal_btn_copy">COPY</button>
                </div>
                
                 <!-- Phone (Optional placeholder if needed, removed for now as not provided) 
                 <div class="copy-row">
                    <span class="copy-text">+33 6 XX XX XX XX</span>
                    <button class="copy-btn" data-copy="+336XXXXXXXX">COPY</button>
                </div> -->

                <div class="copy-feedback">Extraction Successful.</div>
            </div>
        </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modalHTML);

        // 2. Elements
        const modal = document.getElementById('summonModal');
        const closeBtn = modal.querySelector('.modal-close');
        const copyBtns = modal.querySelectorAll('.copy-btn');
        const feedback = modal.querySelector('.copy-feedback');

        // 3. Trigger Logic (Intercept Mailto Links)
        const contactLinks = document.querySelectorAll('a[href^="mailto:"]');
        contactLinks.forEach(link => {
            // Check if it's the specific contact email, regardless of text
            if (link.getAttribute('href') === 'mailto:alexiscarpentier62@gmail.com') {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    openModal();
                });
            }
        });

        // 4. Modal Functions
        function openModal() {
            modal.classList.add('active');
            document.body.style.overflow = 'hidden'; // Stop scrolling
        }

        function closeModal() {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto'; // Resume scrolling
        }

        // 5. Event Listeners
        closeBtn.addEventListener('click', closeModal);

        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });

        copyBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const textToCopy = btn.getAttribute('data-copy');
                const lang = localStorage.getItem('preferredLanguage') || 'fr';

                navigator.clipboard.writeText(textToCopy).then(() => {
                    // Visual Feedback
                    btn.textContent = translations[lang].modal_btn_done;
                    feedback.textContent = `${translations[lang].modal_email_copied} ${textToCopy}`;
                    feedback.classList.add('visible');

                    setTimeout(() => {
                        btn.textContent = translations[lang].modal_btn_copy;
                        feedback.classList.remove('visible');
                    }, 2000);
                }).catch(err => {
                    console.error('Extraction Failed:', err);
                });
            });
        });
    }
});
